---

title: Train LM

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/95a_train_lm[script].ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">fastai2.basics</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai2.text.all</span> <span class="k">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">text_to_img.data_coco</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># all_skip</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Datasets-and-DataLoaders">Datasets and DataLoaders<a class="anchor-link" href="#Datasets-and-DataLoaders">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsets</span> <span class="o">=</span> <span class="n">get_small_lm_dsets</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">dsets</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">seq_len</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading annotations into memory...
Done (t=0.33s)
creating index...
index created!
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>text_</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>xxbos a woman with an umbrella hat holds a cellphone up to her ear . xxbos a brown horse next to a white horse on a field . xxbos xxmaj we are looking at a low angle view of a man in a suit . xxbos xxmaj the gray cat is xxunk in the brown and white cat - shaped cookies . xxbos xxmaj four pieces of a television remote disassembled or</td>
      <td>a woman with an umbrella hat holds a cellphone up to her ear . xxbos a brown horse next to a white horse on a field . xxbos xxmaj we are looking at a low angle view of a man in a suit . xxbos xxmaj the gray cat is xxunk in the brown and white cat - shaped cookies . xxbos xxmaj four pieces of a television remote disassembled or taken</td>
    </tr>
    <tr>
      <th>1</th>
      <td>sitting near a window . xxbos xxmaj three pictures next to each other depicting xxunk . xxbos a cat laying down in a bathroom sink . xxbos a group of gay men standing next to each other under a blue umbrella . xxbos a surfboard leaning on a wheelbarrow in a backyard . xxbos a dog in a field near a fence xxbos a young man catching a blue frisbee in a</td>
      <td>near a window . xxbos xxmaj three pictures next to each other depicting xxunk . xxbos a cat laying down in a bathroom sink . xxbos a group of gay men standing next to each other under a blue umbrella . xxbos a surfboard leaning on a wheelbarrow in a backyard . xxbos a dog in a field near a fence xxbos a young man catching a blue frisbee in a park</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Learner">Learner<a class="anchor-link" href="#Learner">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsets</span> <span class="o">=</span> <span class="n">get_small_lm_dsets</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading annotations into memory...
Done (t=0.32s)
creating index...
index created!
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">xdel</span> dls
<span class="o">%</span><span class="k">xdel</span> learn
<span class="n">dls</span> <span class="o">=</span> <span class="n">dsets</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">seq_len</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">language_model_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">AWD_LSTM</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">Perplexity</span><span class="p">()],</span> <span class="n">wd</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NameError: name &#39;dls&#39; is not defined
NameError: name &#39;learn&#39; is not defined
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SequentialRNN(
  (0): AWD_LSTM(
    (encoder): Embedding(8472, 400, padding_idx=1)
    (encoder_dp): EmbeddingDropout(
      (emb): Embedding(8472, 400, padding_idx=1)
    )
    (rnns): ModuleList(
      (0): WeightDropout(
        (module): LSTM(400, 1152, batch_first=True)
      )
      (1): WeightDropout(
        (module): LSTM(1152, 1152, batch_first=True)
      )
      (2): WeightDropout(
        (module): LSTM(1152, 400, batch_first=True)
      )
    )
    (input_dp): RNNDropout()
    (hidden_dps): ModuleList(
      (0): RNNDropout()
      (1): RNNDropout()
      (2): RNNDropout()
    )
  )
  (1): LinearDecoder(
    (decoder): Linear(in_features=400, out_features=8472, bias=True)
    (output_dp): RNNDropout()
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.09120108485221863, 0.05754399299621582)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="n">e</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>perplexity</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>3.155893</td>
      <td>2.829348</td>
      <td>0.428737</td>
      <td>16.934418</td>
      <td>03:23</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="n">e</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>perplexity</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.854212</td>
      <td>2.694449</td>
      <td>0.447416</td>
      <td>14.797359</td>
      <td>03:25</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2.746078</td>
      <td>2.604133</td>
      <td>0.459724</td>
      <td>13.519504</td>
      <td>03:27</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.622702</td>
      <td>2.537840</td>
      <td>0.468513</td>
      <td>12.652308</td>
      <td>03:25</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2.523185</td>
      <td>2.520245</td>
      <td>0.471572</td>
      <td>12.431646</td>
      <td>03:26</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>input</th>
      <th>target</th>
      <th>pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>xxbos a baseball team celebrates on the field together . xxbos xxmaj two men with surfboards walk toward the beach xxbos xxmaj two hot dogs with toppings sit on foil wrappers . xxbos a bowl of bananas and apples on a table . xxbos a close up of four chocolate covered strawberries on a plate xxbos xxmaj the front edge of a well used skateboard . xxbos a quilt covers a bed</td>
      <td>a baseball team celebrates on the field together . xxbos xxmaj two men with surfboards walk toward the beach xxbos xxmaj two hot dogs with toppings sit on foil wrappers . xxbos a bowl of bananas and apples on a table . xxbos a close up of four chocolate covered strawberries on a plate xxbos xxmaj the front edge of a well used skateboard . xxbos a quilt covers a bed in</td>
      <td>a man player playing a a field with . xxbos a two people are a on through the ocean . a two people dogs with mustard on on a . . xxbos a man of food and a on a table . xxbos a man up of a giraffes donuts donuts on a plate xxbos a two man of of a building - refrigerator . xxbos a man covered a bed with</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a cross street . xxbos a guy in a blue shirt is surfing . xxbos xxmaj there is a piece if luggage that has a rag in it xxbos a female tennis player in a black top playing tennis xxbos a woman that is sitting down with a wine glass . xxbos a baseball player swinging a bat during a baseball game . xxbos xxmaj the man in red and white outfit</td>
      <td>cross street . xxbos a guy in a blue shirt is surfing . xxbos xxmaj there is a piece if luggage that has a rag in it xxbos a female tennis player in a black top playing tennis xxbos a woman that is sitting down with a wine glass . xxbos a baseball player swinging a bat during a baseball game . xxbos xxmaj the man in red and white outfit swings</td>
      <td>man country . xxbos a man is a suit shirt is playing on xxbos a two is a man of cake on is been bag on it xxbos a man tennis player is a blue top and tennis xxbos a man is is standing on with a cell glass . xxbos a man player is a bat at a game game . xxbos a two man is the is white is is</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Save">Save<a class="anchor-link" href="#Save">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># save AWD_LSTM as our encoder</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="s1">&#39;./coco_small/awd_lstm-1.pt&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>8472</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># save vocab</span>
<span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./coco_small/vocab.json&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">dsets</span><span class="o">.</span><span class="n">vocab</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>88801</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

